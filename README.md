# Stellaris Dashboard

Stellaris currently does not have a timeline feature that shows some statistics and historical info, so I decided to build this project. 

Here is a one minute animation of the interactive dashboard in-game:
https://gfycat.com/DifficultForkedGentoopenguin

Alternatively, you can export static images:
https://imgur.com/a/4dhVd

The program runs in the background and reads the autosave files as they are generated by the game. It takes information out of them and compiles that into a database,
which is then used to visualize your progress in various ways.

So far, the program includes information about your:

  - economy: categorized energy, mineral and food budgets (categories such as trade, production, sector income, ship maintenance and many more)
  - science: number of techs, research output or the number of surveyed objects
  - demographics: number of pops, distribution of species
  - factions: size, support and happiness of each faction
  - military: fleet strength

For balance reasons, the program completely ignores Multiplayer and Ironman modes. Also, to not break immersion, only information which is reasonable for you to have is shown, 
so you can only see the military power of empires who are friendly, or who have given you active sensor links or defensive pacts.

# Installation and Use

The Stellaris dashboard requires Python 3.6, which you can download and install from https://www.python.org/.
It is mainly tested in Linux, but it should also work in Windows and theoretically Mac.

  1. Download and extract the repository.
  2. (Optional) create and activate a virtual environment using `virtualenv`. This avoids interfering with any other python programs you use or might use in the future.
  3. (Optional) Open a terminal or command line in the downloaded directory and run `pip install .` to install the program using pip. This should take care of all dependencies and allow you to run the program from anywhere. 
  4. Alternatively, use `pip install -r requirements.txt` to install the dependencies, or install them manually. 
  5. To use the interactive dashboard in-game, copy the contents of the `mod/` folder into your Stellaris mod folder and enable the "Stellaris Dashboard Integration" mod in the game's launcher. Alternatively, you can use your regular browser to view the page.

Note: You may have to use `python -m pip install .` instead of `pip install .` if you use Windows. In this case, just replace `pip` with `python -m pip` wherever necessary.

# Instructions

If you just want the basics: Run the `stellarisdashboard command`. 

If you installed the program in step 3, run `stellarisdashboard` in your console/command line to launch the program in default configuration or `stellarisdashboardcli` to execute specific commands, which are described below.

Otherwise, you can change to the `src/` folder and run `python -m stellarisdashboard` for the default program and `python -m stellarisdashboard.cli` for the CLI if you did not install the program in step 3.


## Default Execution
The command `stellarisdashboard` runs the code to read the save files in the background and starts a local web server for the interactive graphs. 

As the save files are processed in the background, the data is added to a database in your output folder. You can specify this location in the `config.ini` file. By default, every file generated by the dashboard ends up in a subfolder of your user directory, e.g. `$USER/stellarisdashboard/`.

While the program is running, you can access the visualizations by either using a browser to go to `http://127.0.0.1:28053/`, or using the included mod for the in-game browser. 

Note: The current method of reading the save files is a bit slow, so the graphs may lag behind the game quite a bit. For a 1000 star galaxy, reading a single save file can take about 30 seconds...

## Command Line Interface

The command line interface allows you to:

  - Only run the save monitoring without any interactivity. This only builds the database, which you can later visualize (`stellarisdashboardcli monitor_saves`)
  - Produce the static visualizations (`stellarisdashboardcli visualize`)
  - Reparse all existing files. Running `stellarisdashboard` or `stellarisdashboardcli monitor_saves` will ignore any existing save files,
  so sometimes it may be necessary to manually re-parse them. (`stellarisdashboardcli parse_saves`)

Any parameters provided to these commands overwrite the values set in the `config.ini` file.

## Configuration

The following parameters can be specified in a config.ini file placed in the same folder as the stellarisdashboard/config.py file:

  - `save_file_path`: The path where the save files are.
  - `base_output_path`: The path where any files generated by the program end up. This includes the database and any images you generate.
  - `threads`: The number of concurrent processes that are used for reading save files. 
  - `colormap`: The colormap used when producing static images.
  - `port`:  The port where the webapp for the interactive dashboard is served. If you change this, you should adapt the URL in the 
  `mod/Timeline/interface/browser.gui` file accordingly.


# Hardware Requirements

The Hardware requirements depend on many factors:

  - how fast you play
  - the galaxy size
  - how frequently you generate autosaves (monthly, quarterly, yearly)
  - how often you pause the game. 

### CPU
If the dashboard cannot keep up, it will likely skip some saves as they are overwritten by the game and it will skip some data points.

If you have a quad-core CPU or better, I suggest allowing 2 or 3 threads. By default, the program uses one or (n/2) - 1 threads, whichever is higher.

### Disk Space
As for disk space, the dashboard has a fairly small footprint. The database currently uses about 1 MB every ten years with monthly autosaves.
Each game's data is stored in a separate database in your output folder, so you can delete them individually if you wish. 

The game deletes the autosaves in a "rolling" manner, so only the most recent saves are kept. If you plan a long game 
and want to be able to re-generate the database later, you need to continually backup the save files. This can be done by
running a script that automatically copies them to another folder.

This uses a lot more disk space (in my experience about 1 GB every 50 years), but allows you to rebuild the full database at any point using 
`stellarisdashboardcli parse_saves --save-path path/to/your/save_backup`. 

# Bugs

Some known bugs:

  - the economic budget numbers might not exactly match with what is shown in-game. This is because the program almost definitely misses many modifiers. However, most numbers should be accurate enough to get a decent idea.
  - Sometimes the dashboard glitches and adds a line that crosses through most of the graphs. This probably happens because different parts of the program interact with the database at the same time. When this happens, simply kill the program and start it again.
  - The food budget does not match the in-game numbers exactly when sectors are involved. It probably won't deviate too far. This is hard to fix because food is only shown as an integer value in-game.

The program should be fairly stable, but if something weird happens, just restart the app! 


