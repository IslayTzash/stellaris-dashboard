# Stellaris Dashboard

Stellaris currently does not have a timeline feature that shows some statistics and historical info, so I decided to make this project to show more information within the game.

## Graphical Timeline Dashboard

Here is a one minute animation of the interactive dashboard:

https://gfycat.com/RealAnguishedAustralianfreshwatercrocodile

You can also export static images:

https://imgur.com/a/4dhVd

So far, the dashboard shows information about:

  - Economy: detailed categorized energy, mineral and food budgets (categories include production, sector income, trade, ship and pop maintenance, enclave trade deals...)
  - Science: number of techs, research output, exploration (number of surveyed objects)
  - Population: number of pops, species demographics
  - Factions: size, support and happiness of each faction
  - Military: fleet strength
  - Galactic History: Interactive, historical map that shows which country owned which system at any given time

## Event Ledger

The dashboard now also contains a textual ledger listing many historical events:

https://imgur.com/a/t6858co

Currently, this is a list of wars with detailed combat logs, and for each of your leaders, a biography is generated that shows their lifetime achievements, including:

  - Government reforms
  - Ruler mandates and political activities (faction leadership)
  - Passed edicts, researched technologies, embraced traditions and ascension perks
  - Planet colonizations

Much more can be done with this in the future!

## How it works

The stellaris dashboard program runs in the background while you play the game and reads the autosave files as they are generated by the game. It extracts information about the state of the game and adds it to a database, which is then used to visualize your progress. The dashboard also runs a server which can be accessed in-game through the web browser integrated in Stellaris. Of course you can also use any other web browser to look at the dashboard.

To maintain your immersion, only information which is reasonable for you to have is shown, so you can only see the fleet power of empires who are friendly, or who have given you active sensor links or defensive pacts. If you want, you can also configure it to show data of every empire. 

Since with this configuration option, the dashboard allows you to see data like fleet strength of every empire, it is a huge competitive advantage. **For this reason, the dashboard completely ignores Multiplayer and Ironman games.**

Also be aware that the program might not handle reloading of older save games very well. If you rename planets, leaders etc, there might also be issues like duplicate entries or similar problems. I recommend treating the playthrough like Ironman mode: Just see what happens... :-)

The program should be fairly stable, but if something weird happens, first try to restart it! If you run into problems that don't go away after restarting, please let me know here on github or [contact me on reddit](https://www.reddit.com/u/blubblubblob).

# Installation

### Windows
You can also follow my [video tutorial](https://youtu.be/gXpkyL_7jNE?t=379) for the installation in Windows.

  1. Install Python 3.6 or later from https://www.python.org/. 
  ***Make sure to check the "Add Python 3.6 to PATH" option in the first step of the python installer!***
  1. Download the latest release at the [releases page on github](https://github.com/eliasdoehne/stellaris-dashboard/releases)  (Click on "Download Source Code (zip)")
  2. Extract the archive in a location of your choice.
  3. Run the `install.bat` file in the extracted folder by double-clicking it. At this point, Windows may show you a security warning [like this](https://imgur.com/6PIZCmA). If so, click on "More Information" to unlock the "Run anyway" button.
  3. To use the interactive in-game dashboard, install the "Stellaris Dashboard Integration" mod. Do either of the following:
     1. Subscribe to the browser mod [in the Steam Workshop](http://steamcommunity.com/sharedfiles/filedetails/?id=1341242772) (maintained independently by Steam/reddit user 8igualdos0s)
     2. Or manually install it, it is included in the `mod` folder 
  4. To start the program, run the `stellarisdashboard.bat` file. A similar Windows security warning as before may appear.
  5. Activate the mod [in the Stellaris Launcher](https://imgur.com/g7XeZIz)
  6. Play the game!
      
If you want to use the advanced commands from the command line interface (CLI) described below, you will  have to:
  1. Open a command line and navigate to the extracted folder
  2. Activate the virtual environment that is automatically created by `install.bat` using the command `env\Scripts\activate`
  3. Run your CLI command, i.e. execute `python -m stellarisdashboard.cli <your-command-here>`.
  
### Linux 
Ensure that you are using python 3.6 or later when running the commands below. You probably have other python versions installed on your system already.
 
  1. Download the latest release at the [releases page on github](https://github.com/eliasdoehne/stellaris-dashboard/releases)  (Click on "Download Source Code")
  1. Extract the archive and open a terminal in the extracted folder.
  2. (Optional but recommended) Run `python3.6 -m venv env` to create a virtual environment, and activate it by running `source env/bin/activate` whenever you want to use the dashboard. This avoids interference with other python programs you may have installed.
  3. Run `pip3.6 install -e .` to install the program and all dependencies using pip. The `-e` flag tells pip to link to the existing python code instead of copying it to another location, which makes editing your `config.ini` file easier.
  3. To use the interactive in-game dashboard, install the "Stellaris Dashboard Integration" mod. Do either of the following:
     1. Subscribe to the browser mod [in the Steam Workshop](http://steamcommunity.com/sharedfiles/filedetails/?id=1341242772) (maintained independently by Steam/reddit user 8igualdos0s)
     2. Or manually install it, it is included in the `mod` folder.
  4. Activate the mod [in the Stellaris Launcher](https://imgur.com/g7XeZIz)
  5. To start the program, run `stellarisdashboard` (Remember to first activate your virtual environment if you made one! (run `source env/bin/activate`))
  6. Play the game!

These instructions should also work on Mac OS X, although I cannot test this or help with any problems. 

# Instructions

If you just want the basics, run the program while you play the game, either with `stellarisdashboard.bat` on Windows, or by running `stellarisdashboard` in a command line.

While `stellarisdashboard` is running, you can open the in-game browser with the [help button in the bottom right corner of the game UI](https://imgur.com/zWPmrbr), or with the shortcut Alt-B. Then, there should be several buttons in the top right corner of the browser window. Click these to navigate to the various features of the dashboard. Alternatively, you can use any web browser to view the dashboard at [http://127.0.0.1:28053/](http://127.0.0.1:28053/) without installing the mod.

## Command Line Interface

The command line interface allows you to:

  - Only run the save monitoring without any interactivity. This only builds the database, which you can later visualize (command `stellarisdashboardcli monitor_saves`)
  - Produce the static visualizations (command `stellarisdashboardcli visualize`)
  - Reparse all existing files. Running `stellarisdashboard` or `stellarisdashboardcli monitor_saves` will ignore existing save files, so sometimes it may be necessary to manually re-parse them. (command `stellarisdashboardcli parse_saves`)

Parameters provided to these commands override the values set in the `config.ini` file.

## Configuration

The following parameters (and maybe a few more) can be set in the `src/stellarisdashboard/config.ini` file:

  - `save_file_path`: The path where your save files are.
  - `base_output_path`: The path where any files generated by the dashboard are stored. This includes the database files and any images you generate with the `stellarisdashboardcli visualize` command.
  - `threads`: The number of concurrent processes that are used for reading save files. (Recommended: 2 or 3)
  - `colormap`: The colormap used when producing static images. A list of available values can be found here: https://matplotlib.org/examples/color/colormaps_reference.html
  - `port`:  The port where the interactive dashboard is served. If you change this, you should adapt the URL in the `mod/Timeline/interface/browser.gui` file accordingly.
  - `show_everything`: Set to `True` if you want to see the data of all empires.
  - `only_show_default_empires`: Set to `False` in combination with `show_everything=True` if you want to see data from Fallen and Awakened Empires 
  - `extract_system_ownership`: Set to `False` if you do not want to extract ownership data for the interactive galaxy map, as it may be somewhat resource-intensive.
  
Note: Only the `config.ini` file that is in the same directory as the `config.py` will be used. If you installed the program using `pip install .` without the `-e` flag, then this will probably be somewhere else in a `..../site-packages/stellarisdashboard` folder or similar.

# Hardware Requirements

The Hardware requirements depend on several factors:

  - galaxy size
  - how fast you play / how much you pause the game. 
  - how frequently you generate autosaves

## CPU
If the dashboard cannot keep up, it may miss some data or certain events in the event ledger may be recorded incorrectly.

If you have a quad-core CPU or better, I suggest allowing 2 threads. By default, the dashboard uses one less than half of the available threads.

If the dashboard cannot keep up, you can also reduce the Autosave frequency in the Stellaris options menu.

## Disk Space
The database itself should only require a few megabytes. Each game's data is stored in a separate database in your output folder, so you can delete them individually if you wish.

The game continuously deletes the oldest autosave so only the most recent files are kept. If you plan a long game 
and want to be able to re-generate the database later, you need to continually backup the save files yourself.

This uses much more disk space for all the save files, but allows you to rebuild the full database at any point using 
`stellarisdashboardcli parse_saves --save-path path/to/your/save_backup`. 

# Known Issues

  1. Budget numbers (especially for food) do not always match up (but should be reasonably close)
  2. Systems that are added to the map mid-game (e.g. precursor homeworlds) are currently not added to the database.
  3. Reloading old save files may or may not mess up the data base.
  4. Renaming leaders, planets and system might not be reflected in the database and might lead to duplicate or missing entries or other issues.
    
## Contributions

If you want to compile the Cython extensions and run the (currently minimal) unittest suite, you should install Cython and pytest. You can do this by running `pip -r dev-requirements.txt`. 

**Contributions, suggestions and feature requests are appreciated!**

# Acknowledgements

Thanks to [this project](https://github.com/omiddavoodi/StellarisInGameLedger) by reddit user Ariestinak, which inspired the 
approach of modding the in-game browser.

Also thanks to reddit and Steam user 8igualdos0s for maintaining a copy of the browser mod [in the Steam Workshop.](http://steamcommunity.com/sharedfiles/filedetails/?id=1341242772)

The Python code is released under the MIT license:

MIT License

Copyright (c) 2018 Elias Doehne

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
